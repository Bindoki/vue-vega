<html>
<head>
  <title>test</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vega/3.0.0-rc2/vega.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vega-lite/2.0.0-beta.10/vega-lite.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vega-tooltip/0.4.2/vega-tooltip.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/vega-tooltip/0.4.2/vega-tooltip.min.css">
</head>
<body>
<div id="vis"></div>
<button id="control">Update</button>
<script type="text/javascript">

  var initData = [
    {a: 'A', b: 28}, {a: 'B', b: 55}, {a: 'C', b: 43},
    {a: 'D', b: 91}, {a: 'E', b: 81}, {a: 'F', b: 53},
    {a: 'G', b: 19}, {a: 'H', b: 87}, {a: 'I', b: 52}
  ]

  var spec = {
    "$schema": "https://vega.github.io/schema/vega-lite/v2.json",
    "width": 500,
    "height": 500,
    "data": {
      values: initData
    },
    mark: 'bar',
    encoding: {
      x: {field: 'a', type: 'ordinal'},
      y: {field: 'b', type: 'quantitative'}
    }
  };

  var runtime = vega.parse(vl.compile(spec).spec);
  //
  var view = new vega.View(runtime)
    .logLevel(vega.Debug)
    .initialize(document.querySelector("#vis"))
    .render("svg")
    .hover()
    .run();

  view.addEventListener('click', function(event, item) {
    var datum = item.datum;
    var login = datum.login;
    var url = 'https://github.com/' + login;
    console.log('CLICK', event, item);
  });

  document.querySelector('#control').addEventListener('click', function() {
     var newData = [
       {a: 'A', b: 400}, {a: 'B', b: 300}, {a: 'C', b: 200}
     ]

     view.remove('source_0', initData)
     view.insert('source_0', newData)
  })
</script>
</body>
</html>
